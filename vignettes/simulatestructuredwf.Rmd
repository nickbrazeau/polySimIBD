---
title: "Simulate Structure Wright Fisher Forward in Time Model for IBD"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{simulatestructuredwf}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(polySimIBD)
```


```{r}
set.seed(1)
# define parameters
pos <- seq(1,1e3,1e2)
N <- 3
m <- 0.1
rho <- 1e-4 
mean_coi <- 1e3
tlim = 10

start <- Sys.time()
swf <- sim_structured_WF(pos = pos,
                         N = N, 
                         m = m,
                         rho = rho, 
                         mean_coi = mean_coi,
                         tlim = tlim
                         )

# ARG <- get_ARG(swf, nodes = c(1,3))
end <- Sys.time()
end-start

ARG <- get_ARG(swf, nodes = c(1, 4, 9))
ARG
plot_coalescence_trees(ARG, loci = 1,  nodes = c(1, 4, 9))

layer_mutations_on_ARG(mutationrate = 1e3, ARG)



```
